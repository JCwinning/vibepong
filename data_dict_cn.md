# VibePong 数据字典

本文档描述了 VibePong 生成的所有数据文件的结构和含义。

---

## 文件概览

| 文件 | 描述 | 记录频率 |
|------|------|----------|
| `vibepong_summary_*.csv` | 每局游戏汇总统计 | 每局游戏一次 |
| `vibepong_actions_*.csv` | 所有游戏动作的日志 | 每个事件 |
| `vibepong_telemetry_*.csv` | 高频位置数据 | 每100毫秒 |

---

## 1. 汇总数据 (`vibepong_summary_*.csv`)

每局游戏每位玩家一行。包含游戏结束时的统计数据。

| 列名 | 数据类型 | 描述 | 示例 |
|------|----------|------|------|
| `Game ID` | 字符串 | 游戏唯一标识符 | `G1770701255651-120` |
| `Date` | ISO 8601 | 游戏进行时间 | `2026-02-10T05:27:57.952Z` |
| `Duration (s)` | 浮点数 | 游戏总时长（秒） | `22.30` |
| `Winner` | 字符串 | 获胜玩家名称 | `Sune` |
| `Ball Speed` | 浮点数 | 游戏结束时球速 | `8.50` |
| `Theme` | 字符串 | 视觉主题（`dark` 或 `light`） | `dark` |
| `Language` | 字符串 | 语言设置 | `en` |
| `Player` | 字符串 | 该行的玩家名称 | `Sune` |
| `Lives` | 整数 | 游戏结束时剩余生命数 | `1` |
| `Hits` | 整数 | 成功击球总数 | `6` |
| `CPU Difficulty` | 字符串 | AI难度（`easy`、`normal`、`hard`）或 `N/A` | `hard` |

---

## 2. 动作日志 (`vibepong_actions_*.csv`)

基于事件的日志，记录所有重要游戏事件。

| 列名 | 数据类型 | 描述 | 示例 |
|------|----------|------|------|
| `Game ID` | 字符串 | 游戏标识符（外键关联汇总表） | `G1770701255651-120` |
| `Timestamp (ms)` | 整数 | 游戏开始后的毫秒数 | `4802` |
| `Player` | 字符串 | 执行动作的玩家 | `Sune` |
| `Action` | 字符串 | 发生了什么 | `Hit Ball` |
| `Details` | JSON | 附加结构化数据 | `{"ballSpeed": "6.50"}` |

### 常见动作类型

| 动作 | 描述 | 包含的详情 |
|------|------|------------|
| `Ball served towards {player}` | 得分后重新发球 | `targetPlayer`, `targetPlayerId`, `serveAngle` |
| `Hit Ball` | 成功击球 | `ballSpeed`, `hitPosition`, `rallyHits` |
| `Lost Life. Remaining: {n}` | 玩家漏球 | `missLocation`, `ballSpeed`, `rallyHits` |
| `Eliminated` | 玩家生命耗尽出局 | `survivalTime` |

---

## 3. 遥测数据 (`vibepong_telemetry_*.csv`)

高频采样数据（10Hz / 每100毫秒），捕捉完整游戏状态。

### 核心列

| 列名 | 数据类型 | 描述 | 单位 |
|------|----------|------|------|
| `Game ID` | 字符串 | 游戏标识符 | - |
| `Timestamp (ms)` | 整数 | 游戏开始后时间 | 毫秒 |
| `Ball X` | 浮点数 | 球水平位置 | 像素（0-800） |
| `Ball Y` | 浮点数 | 球垂直位置 | 像素（0-600） |
| `Ball VX` | 浮点数 | 球水平速度 | 像素/帧 |
| `Ball VY` | 浮点数 | 球垂直速度 | 像素/帧 |
| `Ball Speed` | 浮点数 | 球速大小（速度向量模） | 像素/帧 |

### 玩家专用列（每位玩家）

对于每位玩家（`p1`、`p2`、`p3`、`p4`），生成以下列：

| 列模式 | 描述 | 单位 |
|--------|------|------|
| `{pX} X` | 挡板水平位置（左边缘） | 像素 |
| `{pX} Y` | 挡板垂直位置（上边缘） | 像素 |
| `{pX} Center` | 挡板中心坐标 | 像素 |
| `{pX} Active` | 玩家是否仍在游戏中（1=是，0=否） | 布尔值 |
| `{pX} Lives` | 当前剩余生命数 | 整数 |
| `{pX} Distance` | 自上次采样以来挡板移动距离 | 像素 |

### 示例行解读

```
游戏ID: G1770701255651-120
时间戳(ms): 4500
球 X: 400.50, 球 Y: 300.25
球 VX: 5.23, 球 VY: -2.11, 球速: 5.65
p1 Y: 250.00, p1 中心: 300.00, p1 活跃: 1, p1 生命: 3, p1 距离: 15.50
```

**解读**：在游戏进行4.5秒时，球位于坐标(400.5, 300.25)，以5.65的速度向右上方移动。玩家1的挡板位于垂直位置250，还有3条生命，自上次采样（100毫秒前）以来移动了15.5像素。

---

## 数据关系

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│ vibepong_summary │────│ vibepong_actions│     │vibepong_telemetry│
│  (每位玩家1行)   │     │  (多个事件)     │     │  (每秒10个样本) │
└─────────────────┘     └─────────────────┘     └─────────────────┘
         │                       │                       │
         └───────────────────────┴───────────────────────┘
                           │
                    ┌─────────────┐
                    │  游戏ID     │
                    │  (主键)     │
                    └─────────────┘
```

---

## 分析注意事项

1. **采样率**：遥测数据以10Hz（每100毫秒）记录。30秒的游戏大约产生300行遥测数据。

2. **球物理**：游戏过程中球速每秒增加约1%（在遥测中可见为`Ball Speed`的上升趋势）。

3. **坐标系**：
   - 2人模式：800x600场地
   - 3人/4人模式：700x700方形场地
   - 原点(0,0)为左上角

4. **缺失数据**：游戏中途被淘汰的玩家将显示`Active=0`，并且不再有遥测位置更新。
