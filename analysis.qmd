---
title: "VibePong Game Data Analysis"
author: "Antigravity AI"
date: last-modified
format:
  html:
    theme: cosmo
    toc: true
    code-fold: true
    code-tools: true
    code-summary: "Show Code"
    code-copy: false
    
execute:
  echo: true
  warning: false
---

# Introduction

In this document, we analyze the game data generated by VibePong. The analysis covers data ingestion, cleaning, and exploratory data analysis (EDA) with visualizations.

# Step 1: Read Data

First, we search for all summary and action CSV files in the `game_data` directory and load them into pandas DataFrames.

```{python}
import pandas as pd
import glob
import os

# Define the data path
data_dir = './game_data'

# Get lists of files
summary_files = glob.glob(os.path.join(data_dir, 'vibepong_summary_*.csv'))
action_files = glob.glob(os.path.join(data_dir, 'vibepong_actions_*.csv'))
telemetry_files = glob.glob(os.path.join(data_dir, 'vibepong_telemetry_*.csv'))

print(f"Found {len(summary_files)} summary files and {len(action_files)} action files and {len(telemetry_files)} action files..")
```



```{python}
# Load and combine summary data
df_summary = pd.concat([pd.read_csv(f) for f in summary_files], ignore_index=True)

# Load and combine action data
df_actions = pd.concat([pd.read_csv(f) for f in action_files], ignore_index=True)

# Load and combine action data
df_telemetry = pd.concat([pd.read_csv(f) for f in telemetry_files], ignore_index=True)
```



## game by game  data
```{python}
# Display the first few rows of summary data
df_summary.head()
```

## Play by Play data
```{python}
# Display the first few rows of summary data
df_actions.head()
```


## time by time data
```{python}
# Display the first few rows of summary data
df_telemetry.head()
```


# Step 2: Data Cleaning

We will clean the data by converting timestamps to datetime objects, handling numeric types, and ensuring consistency.

```{python}
# 1. Convert Date in summary to datetime
df_summary['Date'] = pd.to_datetime(df_summary['Date'])

# 2. Ensure numeric types for metrics
numeric_cols = ['Duration (s)', 'Ball Speed', 'Lives', 'Hits']
for col in numeric_cols:
    df_summary[col] = pd.to_numeric(df_summary[col], errors='coerce')

# 3. Handle Action data timestamps
# Action timestamps are in ms (offset from game start)
df_actions['Timestamp (ms)'] = pd.to_numeric(df_actions['Timestamp (ms)'], errors='coerce')

# 4. Check for missing values
missing_counts = df_summary.isnull().sum()
print("Missing values in Summary data:")
print(missing_counts)

# Drop redundant rows if any (e.g. empty players if they didn't join)
df_summary = df_summary.dropna(subset=['Player'])

# Final head view after cleaning
df_summary.head()
```

# Step 3: EDA and Visualization

Now we'll look at some key performance indicators and visualize the game results.

## Win Distribution

```{python}
import seaborn as sns
import matplotlib.pyplot as plt

# Set aesthetic style
sns.set_theme(style="whitegrid")
plt.rcParams['font.sans-serif'] = ['Arial Unicode MS']
plt.rcParams['axes.unicode_minus'] = False

```

Who is winning the most games?

```{python}


# Count unique games per winner
unique_games = df_summary.drop_duplicates(subset=['Game ID'])
winner_counts = unique_games['Winner'].value_counts()

plt.figure(figsize=(10, 6))
sns.barplot(x=winner_counts.index, y=winner_counts.values, palette="viridis")
plt.title('Number of Wins by Player/CPU', fontsize=15)
plt.ylabel('Games Won')
plt.xlabel('Winner')
plt.show()
```

## Game Duration vs. Ball Speed

Does a higher ball speed lead to shorter games?

```{python}
plt.figure(figsize=(10, 6))
sns.scatterplot(data=unique_games, x='Ball Speed', y='Duration (s)', hue='Winner', s=100)
plt.title('Game Duration vs Ball Speed', fontsize=15)
plt.show()
```

## Total Hits per Player

Tracking the skill (hits) across different game sessions.

```{python}
plt.figure(figsize=(10, 6))
sns.boxplot(data=df_summary, x='Player', y='Hits', palette="magma")
plt.title('Distribution of Hits per Player', fontsize=15)
plt.show()
```

## Sequence of Actions

Analyzing the frequency of actions across all games.

```{python}
action_counts = df_actions['Action'].value_counts().head(10)

plt.figure(figsize=(8, 7))
action_counts.plot(kind='barh', color='skyblue')
plt.title('Most Frequent Actions/Events', fontsize=15)
plt.gca().invert_yaxis()
plt.show()
```

# Step 4: Telemetry Data Analysis

Now let's analyze the high-frequency telemetry data that captures ball and paddle positions every 100ms.


## Ball Speed Over Time

How does ball speed evolve across all games?

```{python}
if telemetry_files and len(df_telemetry) > 0:
    # Get unique game IDs (limit to first 10 for readability)
    unique_games = df_telemetry['Game ID'].unique()[:10]

    plt.figure(figsize=(8, 6))

    for game_id in unique_games:
        df_game = df_telemetry[df_telemetry['Game ID'] == game_id]
        plt.plot(df_game['Timestamp (ms)'] / 1000, df_game['Ball Speed'],
                 linewidth=1.5, alpha=0.7, label=f'Game {game_id[-6:]}')

    plt.xlabel('Time (seconds)')
    plt.ylabel('Ball Speed (pixels/frame)')
    plt.title('Ball Speed Over Time - Multiple Games')
    plt.legend(loc='upper center', bbox_to_anchor=(0.5, -0.15), ncol=5, fontsize=8)
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()
else:
    print("No telemetry data available.")
```

## Ball Trajectory Heatmap

Where does the ball spend most of its time on the court?

```{python}
if telemetry_files and len(df_telemetry) > 0:
    plt.figure(figsize=(10, 7))
    plt.hist2d(df_telemetry['Ball X'], df_telemetry['Ball Y'], bins=50, cmap='hot')
    plt.colorbar(label='Time Spent (samples)')
    plt.xlabel('Ball X Position')
    plt.ylabel('Ball Y Position')
    plt.title('Ball Position Heatmap (All Games)')
    plt.show()
else:
    print("No telemetry data available.")
```

## Paddle Movement Analysis

Which players move their paddles the most?

```{python}
if telemetry_files and len(df_telemetry) > 0:
    # Find all player distance columns
    distance_cols = [col for col in df_telemetry.columns if 'Distance' in col and col != 'Ball Distance']
    player_ids = [col.split()[0] for col in distance_cols]

    if distance_cols:
        # Sum distance moved per game per player
        movement_data = []
        for game_id in df_telemetry['Game ID'].unique():
            df_game = df_telemetry[df_telemetry['Game ID'] == game_id]
            for i, col in enumerate(distance_cols):
                total_movement = df_game[col].sum()
                movement_data.append({
                    'Game ID': game_id,
                    'Player': player_ids[i],
                    'Total Movement': total_movement
                })

        df_movement = pd.DataFrame(movement_data)

        plt.figure(figsize=(8, 6))
        sns.boxplot(data=df_movement, x='Player', y='Total Movement', palette='coolwarm')
        plt.title('Paddle Movement Distance per Player', fontsize=15)
        plt.ylabel('Total Movement (pixels)')
        plt.show()
    else:
        print("No distance columns found in telemetry data.")
else:
    print("No telemetry data available.")
```
